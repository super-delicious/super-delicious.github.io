<!DOCTYPE html>
<html lang="en">
<head>
    <title>Virus Invaders</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
  
    <div id="background">
        <div id="potion"></div>
        <div id="drops"></div>
        <div id="viruses"></div>
    </div>

    <script>
        var potion = {
            left: 575,
            top: 700
        };

        var drops = [];

        var viruses = [
            { left: 200, top: 100 },
            { left: 300, top: 100 },
            { left: 400, top: 100 },
            { left: 500, top: 100 },
            { left: 600, top: 100 },
            { left: 700, top: 100 },
            { left: 800, top: 100 },
            { left: 900, top: 100 },
            { left: 200, top: 175 },
            { left: 300, top: 175 },
            { left: 400, top: 175 },
            { left: 500, top: 175 },
            { left: 600, top: 175 },
            { left: 700, top: 175 },
            { left: 800, top: 175 },
            { left: 900, top: 175 },
            { left: 900, top: 175 },
            { left: 200, top: 250 },
            { left: 300, top: 250 },
            { left: 400, top: 250 },
            { left: 500, top: 250 },
            { left: 600, top: 250 },
            { left: 700, top: 250 },
            { left: 800, top: 250 },
            { left: 900, top: 250 },
            { left: 900, top: 250 }

        ];
        

        document.onkeydown = function(e) {
            if (e.keyCode === 37) {
                // Left
                potion.left = potion.left - 10;
            }
            if (e.keyCode === 39) {
                // Right
                potion.left = potion.left + 10;
            }
            if (e.keyCode === 32) {
                // Spacebar (fire)
                drops.push({
                    left: potion.left + 20,
                    top: potion.top - 20 
                });
                drawDrops()
            }
            drawPotion();
        }


        function drawPotion() {
            document.getElementById('potion').style.left = potion.left + 'px';
            document.getElementById('potion').style.top = potion.top + 'px';
        }

        function drawDrops() {
            document.getElementById('drops').innerHTML = ""
            for(var i = 0 ; i < drops.length ; i++ ) {
                document.getElementById('drops').innerHTML += `<div class='missile1' style='left:${drops[i].left}px; top:${drops[i].top}px'></div>`;
            }
        }

        function moveDrops() {
            for(var i = 0 ; i <drops.length ; i++ ) {
                drops[i].top = drops[i].top - 8
            }
        }

        function drawViruses() {
            document.getElementById('virus').innerHTML = ""
            for(var i = 0 ; i < virus.length ; i++ ) {
                document.getElementById('virus').innerHTML += `<div class='virus' style='left:${virus[i].left}px; top:${virus[i].top}px'></div>`;
            }
        }

        function moveViruses() {
            for(var i = 0 ; i < virus.length ; i++ ) {
                virus[i].top = virus[i].top + 1;
            }
        }

        function collisionDetection() {
            for (var virus = 0; virus < viruses.length; virus++) {
                for (var drop = 0; drop < drops.length; drop++) {
                    if ( 
                        drops[drop].left >= viruses[virus].left  &&
                        drops[drop].left <= (viruses[virus].left + 50)  &&
                        drops[drop].top <= (viruses[virus].top + 50)  &&
                        drops[drop].top >= viruses[virus].top
                    ) {
                        viruses.splice(virus, 1);
                        drops.splice(drop, 1);
                    }
                }
            }
        }

        function gameLoop() {
            setTimeout(gameLoop, 1000)
            moveDrops();
            drawDrops();
            moveVirus();
            drawVirus();
            collisionDetection();
        }
        
        gameLoop()

    </script>
</body>
</html>